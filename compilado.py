import yara, os

folder = os.path.dirname(os.path.abspath(__file__))
#repository = os.path.join(folder, "CAPE")
#repository = os.path.join(folder, "yara")
repository = os.path.join(folder, "todas")

namespace = dict()

for root, dirs, files in os.walk(repository):
	for file in files:
		filename = os.path.join(root, file)
		if os.path.isfile(filename):
			namespace[os.path.basename(filename)] = filename

print(namespace)
rules = yara.compile(filepaths=namespace)
rules.save(os.path.join(folder, "rules_compiled"))